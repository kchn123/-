:root {
  --bg: #f7f5f2;
  --ink: #222;
  --muted: #777;
  --panel: #ffffffc0;
  --maxw: 820px; /* iPadでも読みやすい幅 */
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  background: var(--bg);
  color: var(--ink);
  -webkit-font-smoothing: antialiased;
  font-family: "Hiragino Mincho ProN", "Yu Mincho", "Hiragino Kaku Gothic ProN", serif;
}

.reader {
  min-height: 100dvh;
  display: grid;
  grid-template-rows: auto 1fr auto;
  place-items: stretch;
}

.topbar, .bottombar {
  display: flex; align-items: center; justify-content: space-between;
  padding: 10px 16px;
  background: var(--panel);
  backdrop-filter: blur(6px);
  position: sticky;
}

.topbar { top: 0; }
.bottombar { bottom: 0; }

.title { font-weight: 600; }

.btn {
  border: 1px solid #ddd; background: #fff; padding: 6px 10px; border-radius: 8px; cursor: pointer;
}
.btn:active { transform: translateY(1px); }

.page {
  margin: 0 auto;
  width: min(100%, var(--maxw));
  padding: 20px 24px;
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 6px 30px rgba(0,0,0,.08);
  /* 縦書き（右から左へ） */
  writing-mode: vertical-rl;
  text-orientation: upright;
  line-height: 2;
  /* 見出し・本文の余白感 */
  display: block;
  overflow: auto;
}

/* 詩の本文ブロックの“和書らしい”内側余白感を確保 */
.page .poem {
  margin: 0 auto;
  padding-block: 20%;
  padding-inline: 10%;
}

/* 目次（ポップオーバー風） */
.toc {
  position: fixed; inset: 0;
  background: rgba(255,255,255,.96);
  padding: 24px;
  overflow: auto;
}
.toc.hidden { display: none; }
.toc h2 { margin-block: 0 16px; }
.toc ul { list-style: none; margin: 0; padding: 0; columns: 2; gap: 24px; }
.toc li { margin: 8px 0; }
.toc button {
  width: 100%; text-align: left; border: none; background: transparent; padding: 8px; border-radius: 8px;
}
.toc button:hover { background: #f0f0f0; }

/* タップゾーン（左=次へ / 右=前へ） */
.tapzone {
  position: fixed; top: 0; bottom: 0; width: 35%;
}
.tapzone.left  { left: 0; }
.tapzone.right { right: 0; }

/* プログレス */
.progress { color: var(--muted); font-variant-numeric: tabular-nums; }

/* iPadフルスクリーンでも美しく */
@supports (padding: env(safe-area-inset-bottom)) {
  .topbar    { padding-top: calc(10px + env(safe-area-inset-top)); }
  .bottombar { padding-bottom: calc(10px + env(safe-area-inset-bottom)); }
}
/* ===== 見開きレイアウト（横向き） ===== */
@media (orientation: landscape) {
   .page { 
    writing-mode: horizontal-tb;
    text-orientation: mixed; /* おまじない。無くてもOK */
  }
  .page {
    background: transparent;
    box-shadow: none;
    padding: 0;
  }
  .page.spread {
  display: flex;        /* ← ここをflexにするのがポイント！ */
  flex-direction: row;  /* 横並び */
  gap: 24px;            /* 真ん中の「のど」の幅 */
  margin: 0 auto;
  width: min(100%, var(--maxw));
  justify-content: center;
}


  .leaf {
    flex: 1 1 0;
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 6px 30px rgba(0,0,0,.08);
    padding: 20px 24px;
    writing-mode: vertical-rl;
    text-orientation: upright;
    line-height: 2;
    position: relative;
    min-height: 70vh;         /* 縦の見た目を安定させる */
  }

  /* 和書の雰囲気：内側の影（のどの陰） */
  .leaf.right::after,
  .leaf.left::after {
    content: "";
    position: absolute;
    top: 0; bottom: 0; width: 24px;
    pointer-events: none;
  }
  .leaf.right::after { /* 右ページの内側に陰 */
    left: -24px;
    background: radial-gradient(ellipse at left, rgba(0,0,0,.12), rgba(0,0,0,0) 60%);
  }
  .leaf.left::after {  /* 左ページの内側に陰 */
    right: -24px;
    background: radial-gradient(ellipse at right, rgba(0,0,0,.12), rgba(0,0,0,0) 60%);
  }

  /* 詩ブロックの内側余白（上20% / 下10% 風） */
  .leaf .poem {
    margin: 0 auto;
    padding-block: 20%;
    padding-inline: 10%;
  }
}/* === スワイプ専用運用：ボタン・タップゾーンは隠す === */
.bottombar, .topbar .btn, .tapzone { display: none !important; }

/* === 画面全体の縦スクロールを止める（横スワイプだけ） === */
html, body { overscroll-behavior: contain; touch-action: pan-x; }
.reader { height: 100dvh; overflow: hidden; }

/* === 横向き：見開きレイアウト === */
@media (orientation: landscape) {
  /* 見開き時は親を横書き方向に戻す & 横並び */
  .page.spread {
    writing-mode: horizontal-tb;  /* 親は横方向（flex-rowが横になる） */
    text-orientation: mixed;
    display: flex;
    flex-direction: row;
    gap: 24px;                    /* のど幅 */
    margin: 0 auto;
    width: min(100%, var(--maxw));
    height: 100%;
    justify-content: center;
    background: transparent;
    box-shadow: none;
    padding: 0;
    overflow: hidden;             /* 縦スクロール禁止 */
  }

  .leaf {
    flex: 1 1 0;
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 6px 30px rgba(0,0,0,.08);
    padding: 20px 24px;
    writing-mode: vertical-rl;    /* 子ページは縦書き */
    text-orientation: upright;
    line-height: 2;
    position: relative;
    height: 86vh;                 /* 上下に余白を確保した固定高さ */
    overflow: hidden;             /* 溢れを隠す（字詰めはJSで調整） */
  }

  /* のど（内側）の陰影 */
  .leaf.right::after, .leaf.left::after {
    content: ""; position: absolute; top:0; bottom:0; width:24px; pointer-events:none;
  }
  .leaf.right::after { left:-24px;  background: radial-gradient(ellipse at left, rgba(0,0,0,.12), rgba(0,0,0,0) 60%); }
  .leaf.left::after  { right:-24px; background: radial-gradient(ellipse at right, rgba(0,0,0,.12), rgba(0,0,0,0) 60%); }

  .leaf .poem { margin: 0 auto; padding-block: 20%; padding-inline: 10%; }
}

/* === 縦向き：今回は非対応の注意表示 === */
@media (orientation: portrait) {
  .page { display: none; }
  body::before {
    content: "横向きでご覧ください";
    display: grid; place-items: center; height: 100dvh; color: #666;
  }
}


